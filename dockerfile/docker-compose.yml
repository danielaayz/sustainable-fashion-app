services:
   mongodb:
      container_name: mongodb
      image: mongo
      environment:
         MONGO_INITDB_ROOT_USERNAME: ${MONGO_USER}
         MONGO_INITDB_ROOT_PASSWORD: ${MONGO_PASSWORD}
      ports:
         - "27017:27017"
      volumes:
         - mongo_data:/data/db
   mongo-express:
      image: mongo-express
      depends_on:
         - mongodb
      environment:
         ME_CONFIG_MONGODB_SERVER: "mongodb"
         ME_CONFIG_MONGODB_ADMINUSERNAME: ${MONGO_USER}
         ME_CONFIG_MONGODB_ADMINPASSWORD: ${MONGO_PASSWORD}
         ME_CONFIG_BASICAUTH_USERNAME: ${ME_USER}
         ME_CONFIG_BASICAUTH_PASSWORD: ${ME_PASSWORD}
      ports:
         - "8081:8081"
   backend:
      build:
         context: ..
         dockerfile: dockerfile/Dockerfile.server
      ports:
         - "3001:3001"
      environment:
         MONGODB_URI: "mongodb://mongodb:27017/sustainability_db"
      depends_on:
         - mongodb
   frontend:
      build:
         context: ..
         dockerfile: dockerfile/Dockerfile.client
      ports:
         - "3000:80"
      depends_on:
         - backend
volumes:
   mongo_data:
